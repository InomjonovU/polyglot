{% extends 'base.html' %}
{% load static %}

{% block title %}Sertifikatlar - {{ settings.site_name|default:"PolyglotLC" }}{% endblock %}

{% block content %}
<!-- Page Header -->
<section class="page-header">
    <div class="container">
        <div class="page-header-content">
            <nav class="breadcrumb">
                <a href="{% url 'home' %}">Bosh sahifa</a>
                <span>/</span>
                <span class="current">Sertifikatlar</span>
            </nav>
            <h1 class="page-title">Berilgan <span class="text-gradient">sertifikatlar</span></h1>
            <p class="page-desc">Talabalarimizga berilgan sertifikatlar va ularning yutuqlari</p>
        </div>
    </div>
</section>

<!-- Certificates Section -->
<section class="section-sm">
    <div class="container">
        <!-- Filter Bar -->
        <div class="filter-bar" data-aos="fade-up">
            <form class="filter-form" method="GET" action="">
                <div class="filter-group">
                    <label class="filter-label">Qidiruv</label>
                    <input type="text" name="search" class="filter-input" placeholder="Ism yoki sertifikat raqami..." value="{{ search }}">
                </div>
                <div class="filter-group">
                    <label class="filter-label">Kurs bo'yicha</label>
                    <select name="course" class="filter-select">
                        <option value="">Barcha kurslar</option>
                        {% for course in courses %}
                        <option value="{{ course.slug }}">{{ course.title }}</option>
                        {% endfor %}
                    </select>
                </div>
                <button type="submit" class="btn btn-primary filter-btn">
                    <i class="fas fa-search"></i>
                    <span>Qidirish</span>
                </button>
            </form>
        </div>
        
        <!-- Verify Link -->
        <div class="text-center mb-4" data-aos="fade-up">
            <a href="{% url 'certificate_verify' %}" class="btn btn-secondary">
                <i class="fas fa-shield-alt"></i>
                <span>Sertifikat tekshirish</span>
            </a>
        </div>
        
        <!-- Certificates Grid -->
        <div class="certificates-grid">
            {% for cert in certificates %}
            <div class="certificate-card" data-aos="fade-up" data-aos-delay="{{ forloop.counter0|add:50 }}">
                <div class="certificate-image">
                    {% if cert.certificate_image %}
                    <img src="{{ cert.certificate_image.url }}" alt="{{ cert.student_name }}">
                    {% else %}
                    <img src="https://images.unsplash.com/photo-1571942676516-bcab84649e44?w=400&h=300&fit=crop" alt="{{ cert.student_name }}">
                    {% endif %}
                </div>
                <div class="certificate-content">
                    <h4 class="certificate-name">{{ cert.student_name }}</h4>
                    {% if cert.course %}
                    <p class="certificate-course">{{ cert.course.title }}</p>
                    {% endif %}
                    {% if cert.score %}
                    <p style="color: var(--success); font-weight: 600; margin-bottom: var(--space-sm);">
                        <i class="fas fa-trophy"></i> {{ cert.score }}
                    </p>
                    {% endif %}
                    <div class="certificate-meta">
                        <span class="certificate-number">{{ cert.certificate_number }}</span>
                        <span class="certificate-date">{{ cert.issue_date|date:"d.m.Y" }}</span>
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="empty-state" style="grid-column: 1 / -1;">
                <div class="empty-state-icon">
                    <i class="fas fa-certificate"></i>
                </div>
                <h3>Sertifikatlar topilmadi</h3>
                <p>Qidiruv parametrlarini o'zgartirib ko'ring</p>
            </div>
            {% endfor %}
        </div>
        
        <!-- Pagination -->
        {% if certificates.has_other_pages %}
        <nav class="pagination">
            {% if certificates.has_previous %}
            <a href="?page={{ certificates.previous_page_number }}{% if search %}&search={{ search }}{% endif %}" class="pagination-link">
                <i class="fas fa-chevron-left"></i>
            </a>
            {% endif %}
            
            {% for num in certificates.paginator.page_range %}
                {% if certificates.number == num %}
                <span class="pagination-current">{{ num }}</span>
                {% elif num > certificates.number|add:'-3' and num < certificates.number|add:'3' %}
                <a href="?page={{ num }}{% if search %}&search={{ search }}{% endif %}" class="pagination-link">{{ num }}</a>
                {% endif %}
            {% endfor %}
            
            {% if certificates.has_next %}
            <a href="?page={{ certificates.next_page_number }}{% if search %}&search={{ search }}{% endif %}" class="pagination-link">
                <i class="fas fa-chevron-right"></i>
            </a>
            {% endif %}
        </nav>
        {% endif %}
    </div>
</section>
{% endblock %}
